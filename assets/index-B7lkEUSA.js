import{l as y,u as w,r as I,b as P,e as v,j as e,c as F,n as z,I as p,S as C,D as T}from"./index-DuvEvaeK.js";import{F as _}from"./Table-DWUzUe9Y.js";import{a as m}from"./subscriptions-FjCZdOfp.js";import{useSubscriptionModal as k}from"./use-subscription-modal-CTGSCRm6.js";import D from"./subscription-form-modal-ASaRoRvz.js";import E from"./subscription-filter-qB8X404t.js";import{P as M}from"./index-CGiDtKqU.js";import{C as N}from"./index-BSTsVFyk.js";import"./index-DCzfojox.js";import"./index-DkFJ1ymV.js";import"./Pagination-DmzUxZ-a.js";import"./programs-DArSPDIF.js";const O={active:"processing",succeeded:"success",failed:"default",suspended:"warning",deleted:"error"};function U(){const[u]=y(),{t:r}=w(),[n,a]=I.useState(Object.fromEntries(u.entries())),{data:i,refetch:c,isLoading:l,isFetching:d}=P({queryKey:["subscriptions",n],queryFn:()=>m.get(n),refetchOnWindowFocus:!1}),{modalProps:f,onEdit:x}=k(()=>c()),g=v({mutationFn:s=>m.destroy(s),onSuccess(){c()}});function h(s){a(s)}function j(){a({})}const b=s=>{g.mutate(s.id)},S=[{title:r("app.fields.name"),dataIndex:"name",render:(s,t)=>{var o;return e.jsx("div",{children:(o=t.subscriber)==null?void 0:o.name})}},{title:r("app.fields.program"),dataIndex:"description",render:(s,t)=>{var o;return e.jsx("div",{children:(o=t.program)==null?void 0:o.name})}},{title:r("app.fields.progressPercentage"),dataIndex:"progressPercentage",render:(s,t)=>e.jsxs("div",{children:[t.progressPercentage,"%"]})},{title:r("app.fields.state"),dataIndex:"type",render:(s,t)=>e.jsx(F,{color:O[t.state],children:t.state})},{title:r("app.fields.note"),dataIndex:"description",render:(s,t)=>e.jsx("div",{children:t.notes})},{title:r("common.action"),dataIndex:"operation",width:100,render:(s,t)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(z,{onClick:()=>x(t),children:e.jsx(p,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(M,{title:r("common.confirm-deleting"),okText:r("common.ok"),cancelText:r("common.cancel"),placement:"left",onConfirm:()=>b(t),children:e.jsx("button",{type:"button",children:e.jsx(p,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(C,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(E,{formValue:n,okDisabled:l||d,onClear:j,onSearch:h}),e.jsx(T,{children:r("app.subscriptions.grid-header")}),e.jsxs(N,{title:r("app.subscriptions.grid-header"),children:[e.jsx(_,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:S,dataSource:i==null?void 0:i.items,loading:l||d,pagination:{pageSizeOptions:[10,30,50],current:n.page??1,showSizeChanger:!0,showQuickJumper:!0,total:i==null?void 0:i.total,onChange:(s,t)=>a({...n,page:s,pageSize:t})}}),e.jsx(D,{...f})]})]})}export{U as default};
