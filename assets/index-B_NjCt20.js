import{l as S,u as C,r as u,b as E,e as F,j as e,c as z,T as I,n as P,I as x,S as f,D as N,E as M,B as _}from"./index-DuvEvaeK.js";import{F as L}from"./Table-DWUzUe9Y.js";import{a as h}from"./tasks-eh0bVn-g.js";import{useTaskModal as O}from"./use-task-modal-IhV4gyPq.js";import Y from"./task-form-modal-CCvwpCoW.js";import B from"./task-filter-DvToSIoJ.js";import{d as q}from"./dayjs.min-lKQw1SsZ.js";import{P as K}from"./index-CGiDtKqU.js";import{C as Q}from"./index-BSTsVFyk.js";import"./index-DCzfojox.js";import"./index-DkFJ1ymV.js";import"./Pagination-DmzUxZ-a.js";import"./levels-BFjr8BMX.js";import"./lessons-DW1TOBpR.js";import"./subjects-BjPhUBHv.js";import"./programs-DArSPDIF.js";import"./index-BL8MymNb.js";import"./index-COxOKunJ.js";function oe(){const[o]=S(),{t:i}=C(),[a,r]=u.useState(Object.fromEntries(o.entries())),{data:n,refetch:l,isLoading:c,isFetching:m}=E({queryKey:["tasks",a],queryFn:()=>h.get(a),refetchOnWindowFocus:!1}),{modalProps:j,onCreate:g,onEdit:y}=O(()=>l()),k=F({mutationFn:s=>h.destroy(s),onSuccess(){l()}});u.useEffect(()=>{r(Object.fromEntries(o.entries()))},[o]);function w(s){r(s)}function T(){r({})}const v=s=>{k.mutate(s.id)},b=[{title:i("app.fields.date"),dataIndex:"date",render:(s,t)=>e.jsx("div",{children:q(t.date).format("YYYY-MM-DD")})},{title:i("app.fields.note"),dataIndex:"note",render:(s,t)=>e.jsx("div",{children:t.note})},{title:i("app.fields.type"),dataIndex:"type",render:s=>e.jsx(z,{color:"blue",children:i(`app.tasks.types.${s}`)})},{title:i("common.content"),render:(s,t)=>{var d,p;switch(t.type){case"lesson":return e.jsx("div",{children:((d=t.lessons)==null?void 0:d.map(D=>D.title).join(", "))||"-"});case"assignment":return e.jsx("div",{children:((p=t.assignment)==null?void 0:p.title)||"-"});case"meeting":return e.jsx(I.Link,{href:t.meetingLink,target:"_blank",children:t.meetingLink});case"wird":return e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.wirdTitle}),t.wirdDetails&&e.jsx("div",{className:"text-xs text-secondary",children:t.wirdDetails})]});default:return"-"}}},{title:i("common.action"),dataIndex:"operation",width:100,render:(s,t)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(P,{onClick:()=>y(t),children:e.jsx(x,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(f,{style:{width:10},children:" "}),e.jsx(K,{title:i("common.confirm-deleting"),okText:i("common.ok"),cancelText:i("common.cancel"),placement:"left",onConfirm:()=>v(t),children:e.jsx("button",{type:"button",children:e.jsx(x,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(f,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(B,{formValue:a,okDisabled:c||m,onClear:T,onSearch:w}),e.jsx(N,{children:i("app.tasks.grid-header")}),e.jsxs(Q,{extra:e.jsxs(_,{type:"primary",onClick:()=>g(),children:[" ",i("common.create")," "]}),children:[e.jsx(L,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:b,locale:{emptyText:e.jsx(M,{description:"No Data",children:"Please select a level"})},dataSource:n==null?void 0:n.items,loading:c||m,pagination:{pageSizeOptions:[10,30,50],current:a.page??1,showSizeChanger:!0,showQuickJumper:!0,total:n==null?void 0:n.total,onChange:(s,t)=>r({...a,page:s,pageSize:t})}}),e.jsx(Y,{...j})]})]})}export{oe as default};
