import{aG as h,J as Z,Q as T,G as K,U as ee,aH as W,_ as B,aI as ce,ax as de,aJ as ne,az as ue,H as me,aK as pe,X as fe,aL as ve,r as E,ah as ge,a1 as xe,a2 as ye,ab as O,aM as Ce,a5 as be,aN as he,ag as $e,ay as Ie,al as Pe,aO as Se,aw as J,aP as Ne,aQ as U,u as X,b as ae,j as g,T as je,B as H,I as Q,e as te,S as we,c as ke,aR as Me}from"./index-D30dUQcz.js";import{a as Ae}from"./levels-DdrGcsNV.js";import{a as G}from"./tasks-pIWypiar.js";import Ee from"./task-form-modal-0EF3lYRc.js";import{s as oe}from"./index-Bwj_JxLY.js";import{L as F}from"./index-DRyEevkA.js";import"./dayjs.min-1Tz-y8oh.js";import"./lessons-bLwJnLKw.js";import"./subjects-Bmu98KCm.js";import"./programs-CIsHGAay.js";import"./index-BijjHoeW.js";import"./index-BMojJ2We.js";import"./index-CpcqnRPv.js";import"./index-CrfLqG3m.js";import"./Pagination-Mf8JmUTt.js";var se=h.forwardRef(function(n,e){var a=n.prefixCls,t=n.forceRender,d=n.className,s=n.style,l=n.children,o=n.isActive,m=n.role,u=n.classNames,p=n.styles,v=h.useState(o||t),x=Z(v,2),r=x[0],f=x[1];return h.useEffect(function(){(t||o)&&f(!0)},[t,o]),r?h.createElement("div",{ref:e,className:T("".concat(a,"-content"),K(K({},"".concat(a,"-content-active"),o),"".concat(a,"-content-inactive"),!o),d),style:s,role:m},h.createElement("div",{className:T("".concat(a,"-content-box"),u==null?void 0:u.body),style:p==null?void 0:p.body},l)):null});se.displayName="PanelContent";var Oe=["showArrow","headerClass","isActive","onItemClick","forceRender","className","classNames","styles","prefixCls","collapsible","accordion","panelKey","extra","header","expandIcon","openMotion","destroyInactivePanel","children"],re=h.forwardRef(function(n,e){var a=n.showArrow,t=a===void 0?!0:a,d=n.headerClass,s=n.isActive,l=n.onItemClick,o=n.forceRender,m=n.className,u=n.classNames,p=u===void 0?{}:u,v=n.styles,x=v===void 0?{}:v,r=n.prefixCls,f=n.collapsible,c=n.accordion,C=n.panelKey,y=n.extra,b=n.header,$=n.expandIcon,i=n.openMotion,S=n.destroyInactivePanel,I=n.children,w=ee(n,Oe),P=f==="disabled",N=y!=null&&typeof y!="boolean",j=K(K(K({onClick:function(){l==null||l(C)},onKeyDown:function(A){(A.key==="Enter"||A.keyCode===W.ENTER||A.which===W.ENTER)&&(l==null||l(C))},role:c?"tab":"button"},"aria-expanded",s),"aria-disabled",P),"tabIndex",P?-1:0),R=typeof $=="function"?$(n):h.createElement("i",{className:"arrow"}),L=R&&h.createElement("div",B({className:"".concat(r,"-expand-icon")},["header","icon"].includes(f)?j:{}),R),q=T("".concat(r,"-item"),K(K({},"".concat(r,"-item-active"),s),"".concat(r,"-item-disabled"),P),m),D=T(d,"".concat(r,"-header"),K({},"".concat(r,"-collapsible-").concat(f),!!f),p.header),k=ce({className:D,style:x.header},["header","icon"].includes(f)?{}:j);return h.createElement("div",B({},w,{ref:e,className:q}),h.createElement("div",k,t&&L,h.createElement("span",B({className:"".concat(r,"-header-text")},f==="header"?j:{}),b),N&&h.createElement("div",{className:"".concat(r,"-extra")},y)),h.createElement(de,B({visible:s,leavedClassName:"".concat(r,"-content-hidden")},i,{forceRender:o,removeOnLeave:S}),function(M,A){var z=M.className,_=M.style;return h.createElement(se,{ref:A,prefixCls:r,className:z,classNames:p,style:_,styles:x,isActive:s,forceRender:o,role:c?"tabpanel":void 0},I)}))}),Re=["children","label","key","collapsible","onItemClick","destroyInactivePanel"],Ke=function(e,a){var t=a.prefixCls,d=a.accordion,s=a.collapsible,l=a.destroyInactivePanel,o=a.onItemClick,m=a.activeKey,u=a.openMotion,p=a.expandIcon;return e.map(function(v,x){var r=v.children,f=v.label,c=v.key,C=v.collapsible,y=v.onItemClick,b=v.destroyInactivePanel,$=ee(v,Re),i=String(c??x),S=C??s,I=b??l,w=function(j){S!=="disabled"&&(o(j),y==null||y(j))},P=!1;return d?P=m[0]===i:P=m.indexOf(i)>-1,h.createElement(re,B({},$,{prefixCls:t,key:i,panelKey:i,isActive:P,accordion:d,openMotion:u,expandIcon:p,header:f,collapsible:S,onItemClick:w,destroyInactivePanel:I}),r)})},Te=function(e,a,t){if(!e)return null;var d=t.prefixCls,s=t.accordion,l=t.collapsible,o=t.destroyInactivePanel,m=t.onItemClick,u=t.activeKey,p=t.openMotion,v=t.expandIcon,x=e.key||String(a),r=e.props,f=r.header,c=r.headerClass,C=r.destroyInactivePanel,y=r.collapsible,b=r.onItemClick,$=!1;s?$=u[0]===x:$=u.indexOf(x)>-1;var i=y??l,S=function(P){i!=="disabled"&&(m(P),b==null||b(P))},I={key:x,panelKey:x,header:f,headerClass:c,isActive:$,prefixCls:d,destroyInactivePanel:C??o,openMotion:p,accordion:s,children:e.props.children,onItemClick:S,expandIcon:v,collapsible:i};return typeof e.type=="string"?e:(Object.keys(I).forEach(function(w){typeof I[w]>"u"&&delete I[w]}),h.cloneElement(e,I))};function _e(n,e,a){return Array.isArray(n)?Ke(n,a):ne(e).map(function(t,d){return Te(t,d,a)})}function Be(n){var e=n;if(!Array.isArray(e)){var a=fe(e);e=a==="number"||a==="string"?[e]:[]}return e.map(function(t){return String(t)})}var Le=h.forwardRef(function(n,e){var a=n.prefixCls,t=a===void 0?"rc-collapse":a,d=n.destroyInactivePanel,s=d===void 0?!1:d,l=n.style,o=n.accordion,m=n.className,u=n.children,p=n.collapsible,v=n.openMotion,x=n.expandIcon,r=n.activeKey,f=n.defaultActiveKey,c=n.onChange,C=n.items,y=T(t,m),b=ue([],{value:r,onChange:function(N){return c==null?void 0:c(N)},defaultValue:f,postState:Be}),$=Z(b,2),i=$[0],S=$[1],I=function(N){return S(function(){if(o)return i[0]===N?[]:[N];var j=i.indexOf(N),R=j>-1;return R?i.filter(function(L){return L!==N}):[].concat(ve(i),[N])})};me(!u,"[rc-collapse] `children` will be removed in next major version. Please use `items` instead.");var w=_e(C,u,{prefixCls:t,accordion:o,openMotion:v,expandIcon:x,collapsible:p,destroyInactivePanel:s,onItemClick:I,activeKey:i});return h.createElement("div",B({ref:e,className:y,style:l,role:o?"tablist":void 0},pe(n,{aria:!0,data:!0})),w)});const V=Object.assign(Le,{Panel:re});V.Panel;const ze=E.forwardRef((n,e)=>{const{getPrefixCls:a}=E.useContext(ge),{prefixCls:t,className:d,showArrow:s=!0}=n,l=a("collapse",t),o=T({[`${l}-no-arrow`]:!s},d);return E.createElement(V.Panel,Object.assign({ref:e},n,{prefixCls:l,className:o}))}),He=n=>{const{componentCls:e,contentBg:a,padding:t,headerBg:d,headerPadding:s,collapseHeaderPaddingSM:l,collapseHeaderPaddingLG:o,collapsePanelBorderRadius:m,lineWidth:u,lineType:p,colorBorder:v,colorText:x,colorTextHeading:r,colorTextDisabled:f,fontSizeLG:c,lineHeight:C,lineHeightLG:y,marginSM:b,paddingSM:$,paddingLG:i,paddingXS:S,motionDurationSlow:I,fontSizeIcon:w,contentPadding:P,fontHeight:N,fontHeightLG:j}=n,R=`${O(u)} ${p} ${v}`;return{[e]:Object.assign(Object.assign({},be(n)),{backgroundColor:d,border:R,borderRadius:m,"&-rtl":{direction:"rtl"},[`& > ${e}-item`]:{borderBottom:R,"&:first-child":{[`
            &,
            & > ${e}-header`]:{borderRadius:`${O(m)} ${O(m)} 0 0`}},"&:last-child":{[`
            &,
            & > ${e}-header`]:{borderRadius:`0 0 ${O(m)} ${O(m)}`}},[`> ${e}-header`]:Object.assign(Object.assign({position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:s,color:r,lineHeight:C,cursor:"pointer",transition:`all ${I}, visibility 0s`},he(n)),{[`> ${e}-header-text`]:{flex:"auto"},[`${e}-expand-icon`]:{height:N,display:"flex",alignItems:"center",paddingInlineEnd:b},[`${e}-arrow`]:Object.assign(Object.assign({},$e()),{fontSize:w,transition:`transform ${I}`,svg:{transition:`transform ${I}`}}),[`${e}-header-text`]:{marginInlineEnd:"auto"}}),[`${e}-collapsible-header`]:{cursor:"default",[`${e}-header-text`]:{flex:"none",cursor:"pointer"},[`${e}-expand-icon`]:{cursor:"pointer"}},[`${e}-collapsible-icon`]:{cursor:"unset",[`${e}-expand-icon`]:{cursor:"pointer"}}},[`${e}-content`]:{color:x,backgroundColor:a,borderTop:R,[`& > ${e}-content-box`]:{padding:P},"&-hidden":{display:"none"}},"&-small":{[`> ${e}-item`]:{[`> ${e}-header`]:{padding:l,paddingInlineStart:S,[`> ${e}-expand-icon`]:{marginInlineStart:n.calc($).sub(S).equal()}},[`> ${e}-content > ${e}-content-box`]:{padding:$}}},"&-large":{[`> ${e}-item`]:{fontSize:c,lineHeight:y,[`> ${e}-header`]:{padding:o,paddingInlineStart:t,[`> ${e}-expand-icon`]:{height:j,marginInlineStart:n.calc(i).sub(t).equal()}},[`> ${e}-content > ${e}-content-box`]:{padding:i}}},[`${e}-item:last-child`]:{borderBottom:0,[`> ${e}-content`]:{borderRadius:`0 0 ${O(m)} ${O(m)}`}},[`& ${e}-item-disabled > ${e}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:f,cursor:"not-allowed"}},[`&${e}-icon-position-end`]:{[`& > ${e}-item`]:{[`> ${e}-header`]:{[`${e}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:b}}}}})}},Ge=n=>{const{componentCls:e}=n,a=`> ${e}-item > ${e}-header ${e}-arrow`;return{[`${e}-rtl`]:{[a]:{transform:"rotate(180deg)"}}}},qe=n=>{const{componentCls:e,headerBg:a,borderlessContentPadding:t,borderlessContentBg:d,colorBorder:s}=n;return{[`${e}-borderless`]:{backgroundColor:a,border:0,[`> ${e}-item`]:{borderBottom:`1px solid ${s}`},[`
        > ${e}-item:last-child,
        > ${e}-item:last-child ${e}-header
      `]:{borderRadius:0},[`> ${e}-item:last-child`]:{borderBottom:0},[`> ${e}-item > ${e}-content`]:{backgroundColor:d,borderTop:0},[`> ${e}-item > ${e}-content > ${e}-content-box`]:{padding:t}}}},De=n=>{const{componentCls:e,paddingSM:a}=n;return{[`${e}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${e}-item`]:{borderBottom:0,[`> ${e}-content`]:{backgroundColor:"transparent",border:0,[`> ${e}-content-box`]:{paddingBlock:a}}}}}},Fe=n=>({headerPadding:`${n.paddingSM}px ${n.padding}px`,headerBg:n.colorFillAlter,contentPadding:`${n.padding}px 16px`,contentBg:n.colorBgContainer,borderlessContentPadding:`${n.paddingXXS}px 16px ${n.padding}px`,borderlessContentBg:"transparent"}),Qe=xe("Collapse",n=>{const e=ye(n,{collapseHeaderPaddingSM:`${O(n.paddingXS)} ${O(n.paddingSM)}`,collapseHeaderPaddingLG:`${O(n.padding)} ${O(n.paddingLG)}`,collapsePanelBorderRadius:n.borderRadiusLG});return[He(e),qe(e),De(e),Ge(e),Ce(e)]},Fe),Xe=E.forwardRef((n,e)=>{const{getPrefixCls:a,direction:t,expandIcon:d,className:s,style:l}=Ie("collapse"),{prefixCls:o,className:m,rootClassName:u,style:p,bordered:v=!0,ghost:x,size:r,expandIconPosition:f="start",children:c,destroyInactivePanel:C,destroyOnHidden:y,expandIcon:b}=n,$=Pe(k=>{var M;return(M=r??k)!==null&&M!==void 0?M:"middle"}),i=a("collapse",o),S=a(),[I,w,P]=Qe(i),N=E.useMemo(()=>f==="left"?"start":f==="right"?"end":f,[f]),j=b??d,R=E.useCallback((k={})=>{const M=typeof j=="function"?j(k):E.createElement(Se,{rotate:k.isActive?t==="rtl"?-90:90:void 0,"aria-label":k.isActive?"expanded":"collapsed"});return J(M,()=>{var A;return{className:T((A=M.props)===null||A===void 0?void 0:A.className,`${i}-arrow`)}})},[j,i,t]),L=T(`${i}-icon-position-${N}`,{[`${i}-borderless`]:!v,[`${i}-rtl`]:t==="rtl",[`${i}-ghost`]:!!x,[`${i}-${$}`]:$!=="middle"},s,m,u,w,P),q=E.useMemo(()=>Object.assign(Object.assign({},Ne(S)),{motionAppear:!1,leavedClassName:`${i}-content-hidden`}),[S,i]),D=E.useMemo(()=>c?ne(c).map((k,M)=>{var A,z;const _=k.props;if(_!=null&&_.disabled){const ie=(A=k.key)!==null&&A!==void 0?A:String(M),le=Object.assign(Object.assign({},U(k.props,["disabled"])),{key:ie,collapsible:(z=_.collapsible)!==null&&z!==void 0?z:"disabled"});return J(k,le)}return k}):null,[c]);return I(E.createElement(V,Object.assign({ref:e,openMotion:q},U(n,["rootClassName"]),{expandIcon:R,prefixCls:i,className:L,style:Object.assign(Object.assign({},l),p),destroyInactivePanel:y??C}),D))}),Y=Object.assign(Xe,{Panel:ze});function mn({programId:n,onPrev:e,onFinish:a}){var f;const{t}=X(),[d,s]=E.useState(!1),[l,o]=E.useState(null),[m,u]=E.useState(null),{data:p}=ae({queryKey:["levels",{programId:n}],queryFn:()=>Ae.get({programId:n}),enabled:!!n}),v=c=>{o(c),u({levelId:c,programId:n}),s(!0)},x=c=>{o(c.levelId),u(c),s(!0)},r=()=>{s(!1)};return g.jsxs("div",{className:"space-y-4",children:[g.jsx(je.Title,{level:4,children:t("app.programs.builder.steps.curriculum")}),g.jsx(Y,{defaultActiveKey:(f=p==null?void 0:p.items[0])==null?void 0:f.id,children:p==null?void 0:p.items.map(c=>g.jsx(Y.Panel,{header:c.name,extra:g.jsx(H,{size:"small",type:"dashed",onClick:C=>{C.stopPropagation(),v(c.id)},icon:g.jsx(Q,{icon:"gridicons:add-outline"}),children:t("app.programs.builder.addTask")}),children:g.jsx(Ve,{levelId:c.id,onEditTask:x})},c.id))}),g.jsxs("div",{className:"flex justify-between pt-4",children:[g.jsx(H,{onClick:e,children:t("app.programs.builder.previous")}),g.jsx(H,{type:"primary",onClick:a,children:t("app.programs.builder.finish")})]}),d&&g.jsx(We,{isModalOpen:d,editingTask:m,selectedLevelId:l,programId:n,onCancel:()=>s(!1),onSuccess:r})]})}function Ve({levelId:n,onEditTask:e}){const{t:a}=X(),{data:t,refetch:d,isLoading:s}=ae({queryKey:["tasks",{levelId:n}],queryFn:()=>G.get({levelId:n}),enabled:!!n}),l=te({mutationFn:o=>G.destroy(o),onSuccess:()=>{oe.success(a("common.success")),d()}});return g.jsx(F,{loading:s,dataSource:(t==null?void 0:t.items)||[],renderItem:o=>g.jsx(F.Item,{actions:[g.jsx(H,{type:"text",icon:g.jsx(Q,{icon:"solar:pen-bold-duotone"}),onClick:()=>e(o)},"edit"),g.jsx(H,{type:"text",danger:!0,icon:g.jsx(Q,{icon:"mingcute:delete-2-fill"}),onClick:()=>l.mutate(o.id)},"delete")],children:g.jsx(F.Item.Meta,{title:g.jsxs(we,{children:[g.jsx(ke,{color:o.assignment?"blue":"green",children:a(o.assignment?"app.tasks.types.assignment":"app.tasks.types.lesson")}),o.date]}),description:o.note})}),locale:{emptyText:a("app.programs.builder.noTasks")}})}function We({isModalOpen:n,editingTask:e,selectedLevelId:a,programId:t,onCancel:d,onSuccess:s}){const{t:l}=X(),o=Me(),m=te({mutationFn:u=>u.id?G.update(u.id,u.data):G.create({...u.data,programId:t,levelId:a}),onSuccess:()=>{oe.success(l("common.success")),o.invalidateQueries({queryKey:["tasks",{levelId:a}]}),s()}});return g.jsx(Ee,{title:e!=null&&e.id?l("common.edit"):l("common.create"),show:n,formValue:e||{},okDisabled:m.isPending,onOk:(u,p)=>m.mutate({id:u,data:p}),onCancel:d})}export{mn as default};
