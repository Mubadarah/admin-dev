import{u as _,d as F,r as E,b as T,e as u,j as e,aG as N,B as x,I as o,n as f,S as B,D as L}from"./index-COD1ISQe.js";import{F as $}from"./Table-rZF-o_Mp.js";import{p as c}from"./programs-C-3krbVm.js";import{useProgramModal as h}from"./use-program-modal-D9ieyYku.js";import g from"./program-form-modal-xvcSnbJR.js";import q from"./program-filter-I8X_zq_d.js";import{d as l}from"./dayjs.min-CWT6zsJa.js";import{P as j}from"./index-B6I_5Mwn.js";import{C as K}from"./index-D17wgJ_P.js";import"./index-DjvtY9jd.js";import"./index-B7Fc59nA.js";import"./index-DPtTVPpz.js";import"./index-BTEc5nKY.js";function te(){const{t:a}=_(),b=F(),[r,d]=E.useState({}),{data:n,refetch:s,isLoading:m,isFetching:p}=T({queryKey:["programs",r],queryFn:()=>c.get(r),refetchOnWindowFocus:!1}),{modalProps:y,onCreate:Y,onEdit:v}=h(!1,()=>s()),{modalProps:I,onEdit:k}=h(!0,()=>s()),D=u({mutationFn:i=>c.destroy(i),onSuccess(){s()}}),C=u({mutationFn:i=>c.update(i,{state:"published"}),onSuccess(){s()}});function S(i){d(i)}function M(){d({})}const P=i=>{D.mutate(i.id)},w=i=>{C.mutate(i.id)},z=[{title:a("app.fields.name"),dataIndex:"name",fixed:"left",render:(i,t)=>e.jsx("div",{children:t.name})},{title:a("app.fields.thumbnail"),dataIndex:"name",render:(i,t)=>t.thumbnail&&e.jsx("img",{width:50,height:50,src:`data:image/png;base64,${t.thumbnail}`,alt:"thumbnail"})},{title:a("app.fields.state"),dataIndex:"state",render:(i,t)=>e.jsx("div",{children:a(`app.programs.statuses.${t.state}`)})},{title:a("app.fields.description"),dataIndex:"description",width:300,render:(i,t)=>e.jsx(N,{copyable:!0,ellipsis:!0,children:t.description})},{title:a("app.fields.start"),dataIndex:"start",render:(i,t)=>e.jsx("div",{children:l(t.start).format("YYYY-MM-DD")})},{title:a("app.fields.end"),dataIndex:"end",render:(i,t)=>e.jsx("div",{children:l(t.end).format("YYYY-MM-DD")})},{title:a("app.fields.registration start"),dataIndex:"registrationStart",render:(i,t)=>e.jsx("div",{children:l(t.registrationStart).format("YYYY-MM-DD")})},{title:a("app.fields.registration end"),dataIndex:"registrationEnd",render:(i,t)=>e.jsx("div",{children:l(t.registrationEnd).format("YYYY-MM-DD")})},{title:a("app.levels.title"),dataIndex:"registrationEnd",render:(i,t)=>e.jsx(x,{onClick:()=>b(`/levels?programId=${t.id}`),icon:e.jsx(o,{icon:"solar:layers-minimalistic-broken",size:18}),children:a("app.levels.title")})},{title:a("common.action"),dataIndex:"operation",width:100,fixed:"right",render:(i,t)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(f,{onClick:()=>k(t,a("app.fields.thumbnail")),children:e.jsx(o,{icon:"solar:camera-outline",size:18})}),e.jsx(f,{onClick:()=>v(t),children:e.jsx(o,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(j,{title:a("common.confirm-launch"),okText:a("common.ok"),cancelText:a("common.cancel"),placement:"left",onConfirm:()=>w(t),children:e.jsx("button",{type:"button",children:e.jsx(o,{icon:"solar:rocket-2-broken",size:18,className:"text-success-light"})})}),e.jsx(j,{title:a("common.confirm-deleting"),okText:a("common.ok"),cancelText:a("common.cancel"),placement:"left",onConfirm:()=>P(t),children:e.jsx("button",{type:"button",children:e.jsx(o,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(B,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(q,{formValue:r,okDisabled:m||p,onClear:M,onSearch:S}),e.jsx(L,{children:a("app.programs.grid-header")}),e.jsxs(K,{title:a("app.programs.grid-header"),extra:e.jsxs(x,{type:"primary",onClick:()=>Y(),children:[" ",a("common.create")," "]}),children:[e.jsx($,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:z,dataSource:n==null?void 0:n.items,loading:m||p,pagination:{pageSizeOptions:[10,30,50],current:r.page??1,showSizeChanger:!0,showQuickJumper:!0,total:n==null?void 0:n.total,onChange:(i,t)=>d({...r,page:i,pageSize:t})}}),e.jsx(g,{...y}),e.jsx(g,{...I})]})]})}export{te as default};
