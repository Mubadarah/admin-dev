import{u as S,F as t,r as b,e as h,j as e,g as c,S as E,B as y}from"./index-D30dUQcz.js";import{p as f}from"./programs-CIsHGAay.js";import{d as a}from"./dayjs.min-1Tz-y8oh.js";import{S as F}from"./index-BijjHoeW.js";import{D as u}from"./index-BMojJ2We.js";import{s as I}from"./index-Bwj_JxLY.js";import"./index-CpcqnRPv.js";function P({program:s,onSuccess:g}){const{t:r}=S(),[n]=t.useForm();b.useEffect(()=>{s&&n.setFieldsValue({...s,start:s.start?a(s.start):void 0,end:s.end?a(s.end):void 0,registrationStart:s.registrationStart?a(s.registrationStart):void 0,registrationEnd:s.registrationEnd?a(s.registrationEnd):void 0})},[s,n]);const m=h({mutationFn:i=>s!=null&&s.id?f.update(s.id,i):f.create(i),onSuccess:i=>{I.success(r("common.success")),g(i)}}),x=i=>{const o=a(i.registrationStart),l=a(i.registrationEnd),d=a(i.start),p=a(i.end);if(o.isAfter(d)||o.isSame(d)){n.setFields([{name:"registrationStart",errors:[r("app.programs.errors.registrationStartBeforeProgramStart")]}]);return}if(o.isAfter(l)||o.isSame(l)){n.setFields([{name:"registrationStart",errors:[r("app.programs.errors.registrationStartBeforeregistrationEnd")]}]);return}if(l.isAfter(p)||l.isSame(p)){n.setFields([{name:"registrationEnd",errors:[r("app.programs.errors.registrationEndBeforeProgramEnd")]}]);return}if(d.isAfter(p)||d.isSame(p)){n.setFields([{name:"start",errors:[r("app.programs.errors.programStartBeforeProgramEnd")]}]);return}m.mutate(i)},j=[{value:"public",label:r("app.programs.types.public")},{value:"approval",label:r("app.programs.types.approval")}];return e.jsxs(t,{form:n,layout:"vertical",onFinish:x,initialValues:{programSubscriptionType:"public"},children:[e.jsx(t.Item,{name:"name",label:r("app.fields.name"),rules:[{required:!0}],children:e.jsx(c,{})}),e.jsx(t.Item,{name:"description",label:r("app.fields.description"),rules:[{required:!0}],children:e.jsx(c.TextArea,{rows:4})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(t.Item,{name:"programSubscriptionType",label:r("app.fields.programSubscriptionType"),rules:[{required:!0}],children:e.jsx(F,{options:j})}),e.jsx(t.Item,{name:"subscriptionFormUrl",label:r("app.fields.subscriptionFormUrl"),children:e.jsx(c,{})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(t.Item,{name:"start",label:r("app.fields.start"),rules:[{required:!0}],children:e.jsx(u,{className:"w-full"})}),e.jsx(t.Item,{name:"end",label:r("app.fields.end"),rules:[{required:!0}],children:e.jsx(u,{className:"w-full"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(t.Item,{name:"registrationStart",label:r("app.fields.registration start"),rules:[{required:!0}],children:e.jsx(u,{className:"w-full"})}),e.jsx(t.Item,{name:"registrationEnd",label:r("app.fields.registration end"),rules:[{required:!0}],children:e.jsx(u,{className:"w-full"})})]}),e.jsx(t.Item,{children:e.jsx(E,{className:"w-full justify-end",children:e.jsx(y,{type:"primary",htmlType:"submit",loading:m.isPending,children:r("app.programs.builder.next")})})})]})}export{P as default};
