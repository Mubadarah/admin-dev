import{F as n,r as p,b as o,j as e,w as M,p as t,g as $,i as B}from"./index-D30dUQcz.js";import{d as y}from"./dayjs.min-1Tz-y8oh.js";import{a as N}from"./levels-DdrGcsNV.js";import{l as Q}from"./lessons-bLwJnLKw.js";import{a as G}from"./subjects-Bmu98KCm.js";import{p as H}from"./programs-CIsHGAay.js";import{S as r}from"./index-BijjHoeW.js";import{D as J}from"./index-BMojJ2We.js";import{a as L}from"./index-CrfLqG3m.js";import"./index-CpcqnRPv.js";function ne({title:I,show:F,formValue:l,okDisabled:v,onOk:w,onCancel:q}){var h,j,x,f,b,g;const[c]=n.useForm(),[m,S]=p.useState(void 0),[u,C]=p.useState(void 0);p.useEffect(()=>{c.setFieldsValue({...l})},[l,c]);const P=o({queryKey:["programs"],queryFn:()=>H.get(),refetchOnWindowFocus:!1}),O=o({queryKey:["levels",u],queryFn:()=>N.get({programId:u}),refetchOnWindowFocus:!1}),k=o({queryKey:["subjects"],queryFn:()=>G.get({}),refetchOnWindowFocus:!1}),K=o({queryKey:["assignments"],queryFn:()=>B.get({}),refetchOnWindowFocus:!1}),R=o({queryKey:["lessons",m],queryFn:()=>Q.get({subjectId:m}),refetchOnWindowFocus:!1}),i=(h=P.data)==null?void 0:h.items.map(({id:s,name:a})=>({value:s,label:e.jsx("span",{children:a})}));i==null||i.unshift({value:"",label:e.jsx("span",{children:""})});const T=(j=O.data)==null?void 0:j.items.map(({id:s,name:a})=>({value:s,label:e.jsx("span",{children:a})})),W=(x=K.data)==null?void 0:x.items.map(({id:s,title:a})=>({value:s,label:e.jsx("span",{children:a})})),d=(f=k.data)==null?void 0:f.items.map(({id:s,name:a})=>({value:s,label:e.jsx("span",{children:a})}));d==null||d.unshift({value:"",label:e.jsx("span",{children:""})});const A=(b=R.data)==null?void 0:b.items.map(({id:s,title:a})=>({value:s,label:e.jsx("span",{children:a})})),E=s=>{S(s)},z=s=>{C(s)},D={getValueProps:s=>({value:s&&y(s)}),normalize:s=>s&&`${y(s).toISOString()}`};return e.jsxs(M,{forceRender:!0,title:I,open:F,okButtonProps:{autoFocus:!0,htmlType:"submit",disabled:v},okText:l.id===void 0?t("common.create"):t("common.edit"),cancelText:t("common.cancel"),onCancel:q,modalRender:s=>e.jsx(n,{form:c,initialValues:l,onFinish:a=>w(l.id,a),labelCol:{span:6},wrapperCol:{span:18},layout:"horizontal",children:s}),children:[!l.id&&e.jsx(n.Item,{label:t("app.fields.program"),name:"programId",children:e.jsx(r,{showSearch:!0,options:i,onChange:z})}),!l.id&&e.jsx(n.Item,{label:t("app.fields.level"),name:"levelId",rules:[{required:!0}],children:e.jsx(r,{showSearch:!0,options:T})}),e.jsx(n.Item,{label:t("app.fields.subject"),name:"subjectId",children:e.jsx(r,{showSearch:!0,options:d,onChange:E})}),e.jsx(n.Item,{label:t("app.lessons.title"),name:"lessonIds",children:e.jsx(r,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",defaultValue:(g=l.lessons)==null?void 0:g.map(s=>s.id),options:A})}),e.jsx(n.Item,{label:t("app.fields.assignment"),name:"assignmentId",children:e.jsx(r,{showSearch:!0,options:W})}),e.jsx(n.Item,{label:t("app.fields.date"),name:"date",...D,rules:[{required:!0}],children:e.jsx(J,{style:{width:"100%"}})}),e.jsx(n.Item,{label:t("app.fields.note"),name:"note",children:e.jsx($.TextArea,{})}),e.jsx(n.Item,{label:null,name:"hasChatRoom",valuePropName:"checked",children:e.jsx(L,{children:t("app.fields.hasChatRoom")})})]})}export{ne as default};
