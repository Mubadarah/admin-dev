import{d as F,l as I,u as E,r as a,b as N,e as P,j as e,aZ as M,n as O,I as r,B as g,S as m,D as _,w as B,g as V}from"./index-DuvEvaeK.js";import{F as q}from"./Table-DWUzUe9Y.js";import{a as b}from"./subjects-BjPhUBHv.js";import A from"./subject-filter-CUklmqFX.js";import{C as K}from"./index-BSTsVFyk.js";import{A as L}from"./index-D3OOC9y-.js";import"./index-DCzfojox.js";import"./index-DkFJ1ymV.js";import"./Pagination-DmzUxZ-a.js";import"./programs-DArSPDIF.js";const S="delete";function Y(){const l=F(),[y]=I(),{t:s}=E(),[o,c]=a.useState(Object.fromEntries(y.entries())),[w,d]=a.useState(!1),[p,k]=a.useState(null),[x,u]=a.useState(""),{data:n,refetch:v,isLoading:f,isFetching:j}=N({queryKey:["subjects",o],queryFn:()=>b.get(o),refetchOnWindowFocus:!1}),h=P({mutationFn:t=>b.destroy(t),onSuccess(){v()}});function C(t){c(t)}function T(){c({})}const z=t=>{h.mutate(t.id)},D=[{title:s("app.fields.name"),dataIndex:"name",fixed:"left",render:(t,i)=>e.jsx("div",{children:i.name})},{title:s("app.fields.description"),dataIndex:"description",width:400,render:(t,i)=>e.jsx(M,{copyable:!0,ellipsis:!0,children:i.description})},{title:s("common.action"),key:"operation",fixed:"right",width:100,render:(t,i)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(O,{onClick:()=>l(`/subjects/builder/${i.id}`),children:e.jsx(r,{icon:"solar:magic-stick-3-bold-duotone",size:18})}),e.jsx(g,{onClick:()=>l(`/lessons?subjectId=${i.id}`),icon:e.jsx(r,{icon:"solar:video-frame-play-horizontal-broken",size:18}),children:s("app.lessons.title")}),e.jsx("button",{type:"button",onClick:()=>{k(i),d(!0)},children:e.jsx(r,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})]})}];return e.jsxs(m,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(A,{formValue:o,okDisabled:f||j,onClear:T,onSearch:C}),e.jsx(_,{children:s("app.subjects.grid-header")}),e.jsxs(K,{extra:e.jsx(m,{children:e.jsx(g,{type:"default",onClick:()=>l("/subjects/builder"),icon:e.jsx(r,{icon:"solar:magic-stick-3-bold-duotone"}),children:s("app.subjects.builder.title")})}),children:[e.jsx(q,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:D,dataSource:n==null?void 0:n.items,loading:f||j,pagination:{pageSizeOptions:[10,30,50],current:o.page??1,showSizeChanger:!0,showQuickJumper:!0,total:n==null?void 0:n.total,onChange:(t,i)=>c({...o,page:t,pageSize:i})}}),e.jsx(B,{title:s("common.confirm-deleting"),open:w,onOk:()=>{p&&z(p),d(!1),u("")},okButtonProps:{danger:!0,disabled:x!==S,loading:h.isPending},onCancel:()=>{d(!1),u("")},okText:s("common.delete"),cancelText:s("common.cancel"),children:e.jsxs(m,{direction:"vertical",className:"w-full",size:"middle",children:[e.jsx(L,{message:s("app.subjects.delete-warning"),type:"warning",showIcon:!0}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 font-medium",children:s("app.subjects.delete-confirm-label")}),e.jsx(V,{placeholder:S,value:x,onChange:t=>u(t.target.value),onPaste:t=>t.preventDefault(),autoFocus:!0})]})]})})]})]})}export{Y as default};
