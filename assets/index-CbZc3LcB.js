import{l as b,u as v,r as p,b as D,e as E,j as e,n as F,I as u,S as x,D as I,E as z,B as P}from"./index-D30dUQcz.js";import{F as M}from"./Table-Bp26llHA.js";import{a as f}from"./tasks-pIWypiar.js";import{useTaskModal as _}from"./use-task-modal-CFH5EatR.js";import N from"./task-form-modal-0EF3lYRc.js";import O from"./task-filter-DeVwk6an.js";import{d as Y}from"./dayjs.min-1Tz-y8oh.js";import{P as B}from"./index-DHdriWPD.js";import{C as q}from"./index-Cet01eV5.js";import"./index-BijjHoeW.js";import"./index-CrfLqG3m.js";import"./Pagination-Mf8JmUTt.js";import"./levels-DdrGcsNV.js";import"./lessons-bLwJnLKw.js";import"./subjects-Bmu98KCm.js";import"./programs-CIsHGAay.js";import"./index-BMojJ2We.js";import"./index-CpcqnRPv.js";function ne(){const[l]=b(),{t:o}=v(),[i,a]=p.useState(Object.fromEntries(l.entries())),{data:n,refetch:c,isLoading:m,isFetching:d}=D({queryKey:["tasks",i],queryFn:()=>f.get(i),refetchOnWindowFocus:!1}),{modalProps:h,onCreate:j,onEdit:g}=_(()=>c()),y=E({mutationFn:t=>f.destroy(t),onSuccess(){c()}});p.useEffect(()=>{a(Object.fromEntries(l.entries()))},[l]);function k(t){a(t)}function S(){a({})}const w=t=>{y.mutate(t.id)},C=[{title:o("app.fields.date"),dataIndex:"date",render:(t,s)=>e.jsx("div",{children:Y(s.date).format("YYYY-MM-DD")})},{title:o("app.fields.note"),dataIndex:"note",render:(t,s)=>e.jsx("div",{children:s.note})},{title:o("app.lessons.title"),dataIndex:"lessons",render:(t,s)=>{var r;return e.jsx("div",{children:((r=s.lessons)==null?void 0:r.map(T=>T.title).join(", "))??"-"})}},{title:o("app.fields.assignment"),dataIndex:"assignment",render:(t,s)=>{var r;return e.jsx("div",{children:((r=s.assignment)==null?void 0:r.title)??"-"})}},{title:o("common.action"),dataIndex:"operation",width:100,render:(t,s)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(F,{onClick:()=>g(s),children:e.jsx(u,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(x,{style:{width:10},children:" "}),e.jsx(B,{title:o("common.confirm-deleting"),okText:o("common.ok"),cancelText:o("common.cancel"),placement:"left",onConfirm:()=>w(s),children:e.jsx("button",{type:"button",children:e.jsx(u,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(x,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(O,{formValue:i,okDisabled:m||d,onClear:S,onSearch:k}),e.jsx(I,{children:o("app.tasks.grid-header")}),e.jsxs(q,{extra:e.jsxs(P,{type:"primary",onClick:()=>j(),children:[" ",o("common.create")," "]}),children:[e.jsx(M,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:C,locale:{emptyText:e.jsx(z,{description:"No Data",children:"Please select a level"})},dataSource:n==null?void 0:n.items,loading:m||d,pagination:{pageSizeOptions:[10,30,50],current:i.page??1,showSizeChanger:!0,showQuickJumper:!0,total:n==null?void 0:n.total,onChange:(t,s)=>a({...i,page:t,pageSize:s})}}),e.jsx(N,{...h})]})]})}export{ne as default};
